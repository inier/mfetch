!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t(e.Mfetch=e.Mfetch||{})}(this,function(e){"use strict";function t(e){return e&&e.__esModule?e.default:e}function n(e,t){return t={exports:{}},e(t,t.exports),t.exports}function r(e){if(null===e||void 0===e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}function i(e){switch(e.arrayFormat){case"index":return function(t,n,r){return null===n?[u(t,e),"[",r,"]"].join(""):[u(t,e),"[",u(r,e),"]=",u(n,e)].join("")};case"bracket":return function(t,n){return null===n?u(t,e):[u(t,e),"[]=",u(n,e)].join("")};default:return function(t,n){return null===n?u(t,e):[u(t,e),"=",u(n,e)].join("")}}}function o(e){var t;switch(e.arrayFormat){case"index":return function(e,n,r){if(t=/\[(\d*)\]$/.exec(e),e=e.replace(/\[\d*\]$/,""),!t)return void(r[e]=n);void 0===r[e]&&(r[e]={}),r[e][t[1]]=n};case"bracket":return function(e,n,r){return t=/(\[\])$/.exec(e),e=e.replace(/\[\]$/,""),t?void 0===r[e]?void(r[e]=[n]):void(r[e]=[].concat(r[e],n)):void(r[e]=n)};default:return function(e,t,n){if(void 0===n[e])return void(n[e]=t);n[e]=[].concat(n[e],t)}}}function u(e,t){return t.encode?t.strict?x(e):encodeURIComponent(e):e}function c(e){return Array.isArray(e)?e.sort():"object"==typeof e?c(Object.keys(e)).sort(function(e,t){return Number(e)-Number(t)}).map(function(t){return e[t]}):e}function a(e){return J.call(e).slice(8,-1)}function s(e){var t=e.map(function(e){return"["+e+"]"});return t[0]=e[0],t.join("")}function f(e){if(!N(e))throw new TypeError("Argument must be object");var t=new V,n=new F(e),r=function(e,n,r){var i=s(e);q(r)?t.append(i,n):t.append(i,n,r)};n.onStepInto=function(e){e.parent;switch(a(e.node)){case"Array":case"Object":case"FileList":return!0;default:return!1}};for(var i=0,o=n;i<o.length;i+=1){var u=o[i],c=u.node,f=u.path;switch(a(c)){case"Array":case"Object":case"FileList":break;case"File":r(f,c);break;case"Blob":r(f,c,c.name);break;default:r(f,c)}}return t}function l(e){for(var t={},n=0,r=e.keys();n<r.length;n+=1){var i=r[n];t.hasOwnProperty(i)?t[i]=e.getAll(i):t[i]=e.get(i)}return t}var p="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},d=n(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=t.isType=function(e){return function(t){return null!=t&&Object.prototype.toString.call(t)==="[object "+e+"]"}};t.isFn=n("Function"),t.isArr=Array.isArray||n("Array"),t.isObj=n("Object"),t.isStr=n("String"),t.isNum=n("Number")});t(d);var h=n(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.lowerCase=t.each=t.extend=t.isValidThen=t.isValid=t.hasOwn=t.hasOwnProperty=t.obj=t.getStr=t.getFn=t.noop=void 0;var n=d,r=t.noop=function(e){return function(){return e}},i=(t.getFn=function(e,t){return(0,n.isFn)(e)?e:r(t)},t.getStr=function(e){return(0,n.isStr)(e)?e:""}),o=(t.obj=function(){return Object.create(null)},t.hasOwnProperty=Object.prototype.hasOwnProperty),u=t.hasOwn=function(e,t){return o.call(e,t)},c=t.isValid=function(e){return void 0!==e&&null!==e};t.isValidThen=function(e,t){return c(e)?e:t},t.extend=function(e,t){for(var n in t)e[n]=t[n];return e},t.each=function(e,t){if((0,n.isFn)(t))if((0,n.isArr)(e))for(var r=0,i=e.length;r<i&&!1!==t(e[r],r);r++);else for(var o in e)if(u(e,o)&&!1===t(e[o],o))break},t.lowerCase=function(e){return i(e).toLowerCase()}});t(h);var v=n(function(e,t){function n(e){function t(t,n,r){return function(t){return n.call(new e(t),t,(0,i.getFn)(r,t))}}function n(e){return(0,i.lowerCase)(e).replace(/process/i,"")}function o(e,u){if((0,r.isObj)(e))(0,i.each)(e,function(e,t){o(t,e)});else{if(e=n(e),!(0,r.isFn)(u))return;s[e]=t(e,u,s[e])}}function u(e,t,o){return(0,r.isStr)(e)&&e.length&&(e=n(e),(0,r.isFn)(s[e]))?s[e](t):(0,i.isValidThen)(o,t)}function c(e,t){if(!(0,i.isValid)(t))return cached[e];cached[e]=t}function a(e){(0,r.isArr)(e)?(0,i.each)(e,function(e){return a(e)}):(0,r.isFn)(e)?e(f):o(e)}var s=(0,i.obj)();e=e||(0,i.noop)();var f={process:o,post:u,extension:a,cache:c};return e.prototype=(0,i.extend)(e.prototype,f),f}Object.defineProperty(t,"__esModule",{value:!0}),t.createPluginService=n;var r=d,i=h});t(v);var g,b=v.createPluginService,m=function(e){return encodeURIComponent(e).replace(/[!'()*]/g,function(e){return"%"+e.charCodeAt(0).toString(16).toUpperCase()})},y=Object.getOwnPropertySymbols,j=Object.prototype.hasOwnProperty,O=Object.prototype.propertyIsEnumerable,w=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},n=0;n<10;n++)t["_"+String.fromCharCode(n)]=n;if("0123456789"!==Object.getOwnPropertyNames(t).map(function(e){return t[e]}).join(""))return!1;var r={};return"abcdefghijklmnopqrst".split("").forEach(function(e){r[e]=e}),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},r)).join("")}catch(e){return!1}}()?Object.assign:function(e,t){for(var n,i,o=arguments,u=r(e),c=1;c<arguments.length;c++){n=Object(o[c]);for(var a in n)j.call(n,a)&&(u[a]=n[a]);if(y){i=y(n);for(var s=0;s<i.length;s++)O.call(n,i[s])&&(u[i[s]]=n[i[s]])}}return u},x=m,A=w,C=function(e){return e.split("?")[1]||""},_=function(e,t){t=A({arrayFormat:"none"},t);var n=o(t),r=Object.create(null);return"string"!=typeof e?r:(e=e.trim().replace(/^(\?|#|&)/,""))?(e.split("&").forEach(function(e){var t=e.replace(/\+/g," ").split("="),i=t.shift(),o=t.length>0?t.join("="):void 0;o=void 0===o?null:decodeURIComponent(o),n(decodeURIComponent(i),o,r)}),Object.keys(r).sort().reduce(function(e,t){var n=r[t];return Boolean(n)&&"object"==typeof n&&!Array.isArray(n)?e[t]=c(n):e[t]=n,e},Object.create(null))):r},S=function(e,t){t=A({encode:!0,strict:!0,arrayFormat:"none"},t);var n=i(t);return e?Object.keys(e).sort().map(function(r){var i=e[r];if(void 0===i)return"";if(null===i)return u(r,t);if(Array.isArray(i)){var o=[];return i.slice().forEach(function(e){void 0!==e&&o.push(n(r,e,o.length))}),o.join("&")}return u(r,t)+"="+u(i,t)}).filter(function(e){return e.length>0}).join("&"):""},k={extract:C,parse:_,stringify:S},P=n(function(e,t){!function(n,r){"object"==typeof t&&"object"==typeof e?e.exports=r():"function"==typeof define&&define.amd?define([],r):"object"==typeof t?t.RecursiveIterator=r():n.RecursiveIterator=r()}(p,function(){return function(e){function t(r){if(n[r])return n[r].exports;var i=n[r]={exports:{},id:r,loaded:!1};return e[r].call(i.exports,i,i.exports,t),i.loaded=!0,i.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){var r=function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)},i=function(e,t,n){t&&Object.defineProperties(e,t),n&&Object.defineProperties(e.prototype,n)},o=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},u=n(1),c=u.isObject,a=u.getKeys,s="__bypassMode",f="__ignoreCircular",l="__maxDeep",p="__cache",d="__queue",h="__state",v={},g=function(){function e(t){var n=void 0===arguments[1]?0:arguments[1],r=void 0!==arguments[2]&&arguments[2],i=void 0===arguments[3]?100:arguments[3];o(this,e),this[s]=n,this[f]=r,this[l]=i,this[p]=[],this[d]=[],this[h]=this.getState(void 0,t),this.__makeIterable()}return i(e,null,{next:{value:function(){var e=this[h]||v,t=e.node,n=e.path,i=e.deep;if(this[l]>i&&this.isNode(t))if(this.isCircular(t)){if(!this[f])throw new Error("Circular reference")}else if(this.onStepInto(this[h])){var o,u=this.getStatesOfChildNodes(t,n,i),c=this[s]?"push":"unshift";(o=this[d])[c].apply(o,r(u)),this[p].push(t)}var a=this[d].shift(),g=!a;return this[h]=a,g&&this.destroy(),{value:a,done:g}},writable:!0,configurable:!0},destroy:{value:function(){this[d].length=0,this[p].length=0,this[h]=null},writable:!0,configurable:!0},isNode:{value:function(e){return c(e)},writable:!0,configurable:!0},isLeaf:{value:function(e){return!this.isNode(e)},writable:!0,configurable:!0},isCircular:{value:function(e){return-1!==this[p].indexOf(e)},writable:!0,configurable:!0},getStatesOfChildNodes:{value:function(e,t,n){var r=this;return a(e).map(function(i){return r.getState(e,e[i],i,t.concat(i),n+1)})},writable:!0,configurable:!0},getState:{value:function(e,t,n){return{parent:e,node:t,key:n,path:void 0===arguments[3]?[]:arguments[3],deep:void 0===arguments[4]?0:arguments[4]}},writable:!0,configurable:!0},onStepInto:{value:function(e){return!0},writable:!0,configurable:!0},__makeIterable:{value:function(){var e=this;try{this[Symbol.iterator]=function(){return e}}catch(e){}},writable:!0,configurable:!0}}),e}();e.exports=g},function(e,t){function n(e){return null!==e&&"object"==typeof e}function r(e){if(!n(e))return!1;if(!("length"in e))return!1;var t=e.length;if(!i(t))return!1;if(t>0)return t-1 in e;for(var r in e)return!1}function i(e){return"number"==typeof e}function o(e){var t=Object.keys(e);if(u(e));else if(r(e)){var n=t.indexOf("length");n>-1&&t.splice(n,1)}else t=t.sort();return t}t.isObject=n,t.isArrayLike=r,t.isNumber=i,t.getKeys=o;var u=t.isArray=Array.isArray;Object.defineProperty(t,"__esModule",{value:!0})}])})}),F=t(P),I=function(e){return function(t){return Object.prototype.toString.call(t)==="[object "+e+"]"}},R=I("Function"),U=Array.isArray||I("Array"),N=I("Object"),T=I("String"),E=I("FormData"),q=I("Undefined"),M=I("Number"),L=function(e){return String(e).toLocaleLowerCase()},B=function(e){return L(e.method)},V=window.FormData,D=Object.prototype,J=D.toString,$=function(e){return L(String(e)).replace(/\s+/gi,"")},z=function(e,t){return $(e)===$(t)},K=function(e){return $(U(e)?e.join("/"):T(e)?e:"")},H=function(e){return Object.keys(e||{})},G=function(e,t){return e?H(e).some(function(e){return z(e,t)}):e},Q=function(e,t){if(!e)return e;for(var n=H(e),r=0;r<n.length;r++){e[n[r]];if(z(t,n[r]))return n[r]}return""},W=function(e,t){return e?e[Q(e,t)]||"":e},X=function(e,t){return e?(delete e[Q(e,t)],e):e},Y=function(e,t){if(!e)return!1;var n=e.headers;H(n);return!!G(n,"content-type")&&W(n,"content-type").indexOf(K(t))>-1},Z=function(e,t){H(e);return H(t).reduce(function(e,n){var r=Q(e,n);return r?e[r]=t[n]:e[n]=t[n],e},e||{})},ee=function(e,t,n,r){return Promise.resolve(t(e)).then(function(e){return Promise.resolve(n?n(e):e)},function(e){return Promise.reject(r?r(e):e)})},te=function(e){if(e instanceof URL)return e;var t=document.createElement("a");return t.href=e,t},ne=function(e){var t=e.query_string;return function(e,n,r){var i=te(n);return i.search=t.stringify(r,e),i.href}},re=function(e){var t=e.query_string;return function(e,n){return t.parse(t.extract(te(n).search),e)}},ie=function(e){var t=e.query_string,n=e.form_data;return function(e,r){var i={};return T(r)?t.parse(r,e):E(r)?n.parse(r,e):N(r)?r:i}},oe=function(e){var t=e.query_string,n=e.form_data;return function(e,r){var i=function(t){return Y(e,t)};return i(["application","json"])?JSON.stringify(r):i(["multipart","formdata"])||i(["multipart","form-data"])?(X(e.headers,"content-type"),n.formify(r,e)):t.stringify(r,e)}},ue=function(e,t){return Object.keys(e||{}).reduce(function(n,r){return-1==t.indexOf(r)&&(n[r]=e[r]),n},{})},ce=function(e,t){return Object.keys(e||{}).reduce(function(n,r){return t.indexOf(r)>-1&&(n[r]=e[r]),n},{})},ae=function(e,t){return function(n){for(var r=[],i=arguments.length-1;i-- >0;)r[i]=arguments[i+1];return n(e.post("serializer",t)).apply(void 0,r)}},se={processFetch:function(e,t){return e=t(e),this.options=e,window.fetch(e.url,e)},processRequest:function(e,t){var n=this;return ee(e,t,function(e){if(M(e.timeout)){var t=e.timeout;delete e.timeout;var r,i=new Promise(function(e,t){r=function(e){t(e)}});setTimeout(function(){var t=new Error('[MFETCH Error] request "'+e.url+'" is timeout!');t.isTimeout=!0,r(t)},t);var o=Promise.race([n.post("fetch",e),i]);return o.abort=r,n.post("response",o)}return n.post("response",n.post("fetch",e))})},processSerializer:function(e){return{query_string:{parse:k.parse,stringify:k.stringify,extract:k.extract},form_data:{parse:l,formify:f}}},processAfterOption:function(e,t){e=t(e);var n=e.uri?e.uri.varNames:[],r=ae(this,e);switch(e.params=r(ie,e,e.params),e.url=e.uri?e.uri.fill(ce(e.params,n)):e.url,delete e.uri,B(e)){case"get":case"jsonp":case"head":var i=Object.assign(r(re,e,e.url),ue(e.params,n));return e.url=r(ne,e,e.url,i),e;default:return e.body=r(oe,e,Object.assign(r(ie,e,e.body),ue(e.params,n))),e}}},fe={request:function(e){return{processAfterOption:function(t,n){return Promise.resolve(R(e)?e(t,this.options):t).then(function(e){return n(e)})}}},response:function(e){return{processResponse:function(t,n){var r=this;return ee(t,n,function(t){return R(e)?e(t,r.options):t})}}},resolve:function(e){return{processResponse:function(t,n){var r=this;return ee(t,n,function(t){return R(e)?e(t,r.options):t})}}},reject:function(e){return{processResponse:function(t,n){var r=this;return ee(t,n,function(e){return e},function(t){return R(e)?e(t,r.options):t})}}}},le=function(e){return Object.keys(e||{}).reduce(function(t,n){return fe[n]&&R(e[n])?t.concat(fe[n](e[n].bind(e))):t},[])},pe=function(e){return{processOption:function(t,n){switch(t=n(t),B(t)){case"get":case"head":return t;default:return t.body=e,t}}}},de=function(e){return{processOption:function(t,n){return t=n(t),t.headers=Z(t.headers,e),t}}},he=n(function(e,t){!function(n,r){if("function"==typeof define&&define.amd)define(["exports","module"],r);else if(void 0!==t&&void 0!==e)r(t,e);else{var i={exports:{}};r(i.exports,i),n.fetchJsonp=i.exports}}(p,function(e,t){function n(){return"jsonp_"+Date.now()+"_"+Math.ceil(1e5*Math.random())}function r(e){try{delete window[e]}catch(t){window[e]=void 0}}function i(e){var t=document.getElementById(e);t&&document.getElementsByTagName("head")[0].removeChild(t)}function o(e){var t=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],o=e,c=t.timeout||u.timeout,a=t.jsonpCallback||u.jsonpCallback,s=void 0;return new Promise(function(u,f){var l=t.jsonpCallbackFunction||n(),p=a+"_"+l;window[l]=function(e){u({ok:!0,json:function(){return Promise.resolve(e)}}),s&&clearTimeout(s),i(p),r(l)},o+=-1===o.indexOf("?")?"?":"&";var d=document.createElement("script");d.setAttribute("src",""+o+a+"="+l),t.charset&&d.setAttribute("charset",t.charset),d.id=p,document.getElementsByTagName("head")[0].appendChild(d),s=setTimeout(function(){f(new Error("JSONP request to "+e+" timed out")),r(l),i(p)},c),d.onerror=function(){f(new Error("JSONP request to "+e+" failed")),r(l),i(p),s&&clearTimeout(s)}})}var u={timeout:5e3,jsonpCallback:"callback",jsonpCallbackFunction:null};t.exports=o})}),ve=function(e){return{processOption:function(t,n){return t=n(t),t.method=L(e),t.method.indexOf("get")>-1&&t.headers&&(t.headers=X(t.headers,"content-type")),t},processFetch:function(e,t){return"jsonp"==e.method?he(e.url,e):t(e)}}},ge=n(function(e){!function(t,n){"function"==typeof define&&define.amd?define("uri-templates",[],n):void 0!==e&&e.exports?e.exports=n():t.UriTemplate=n()}(p,function(){function e(e){return encodeURI(e).replace(/%25[0-9][0-9]/g,function(e){return"%"+e.substring(3)})}function t(e){return e=e.replace(/%../g,""),encodeURIComponent(e)===e}function n(n){var r="";i[n.charAt(0)]&&(r=n.charAt(0),n=n.substring(1));var u="",c="",a=!0,s=!1,f=!1;"+"==r?a=!1:"."==r?(c=".",u="."):"/"==r?(c="/",u="/"):"#"==r?(c="#",a=!1):";"==r?(c=";",u=";",s=!0,f=!0):"?"==r?(c="?",u="&",s=!0):"&"==r&&(c="&",u="&",s=!0);for(var l=[],p=n.split(","),d=[],h={},v=0;v<p.length;v++){var g=p[v],b=null;if(-1!=g.indexOf(":")){var m=g.split(":");g=m[0],b=parseInt(m[1])}for(var y={};o[g.charAt(g.length-1)];)y[g.charAt(g.length-1)]=!0,g=g.substring(0,g.length-1);var j={truncate:b,name:g,suffices:y};d.push(j),h[g]=j,l.push(g)}return{varNames:l,prefix:c,substitution:function(t){for(var n="",r=0,i=0;i<d.length;i++){var o=d[i],l=t(o.name);if(null==l||Array.isArray(l)&&0==l.length||"object"==typeof l&&0==Object.keys(l).length)r++;else if(n+=i==r?c:u||",",Array.isArray(l)){s&&(n+=o.name+"=");for(var p=0;p<l.length;p++)p>0&&(n+=o.suffices["*"]?u||",":",",o.suffices["*"]&&s&&(n+=o.name+"=")),n+=a?encodeURIComponent(l[p]).replace(/!/g,"%21"):e(l[p])}else if("object"==typeof l){s&&!o.suffices["*"]&&(n+=o.name+"=");var h=!0;for(var v in l)h||(n+=o.suffices["*"]?u||",":","),h=!1,n+=a?encodeURIComponent(v).replace(/!/g,"%21"):e(v),n+=o.suffices["*"]?"=":",",n+=a?encodeURIComponent(l[v]).replace(/!/g,"%21"):e(l[v])}else s&&(n+=o.name,f&&""==l||(n+="=")),null!=o.truncate&&(l=l.substring(0,o.truncate)),n+=a?encodeURIComponent(l).replace(/!/g,"%21"):e(l)}return n},unSubstitution:function(e,n,r){if(c&&(e=e.substring(c.length)),1==d.length&&d[0].suffices["*"]){for(var i=d[0],o=i.name,f=i.suffices["*"]?e.split(u||","):[e],l=a&&-1!=e.indexOf("="),p=1;p<f.length;p++){var e=f[p];l&&-1==e.indexOf("=")&&(f[p-1]+=(u||",")+e,f.splice(p,1),p--)}for(var p=0;p<f.length;p++){var e=f[p];a&&-1!=e.indexOf("=")&&(l=!0);var v=e.split(",");1==v.length?f[p]=v[0]:f[p]=v}if(s||l){for(var g=n[o]||{},b=0;b<f.length;b++){var m=e;if(!s||m){if("string"==typeof f[b]){var e=f[b],y=e.split("=",1)[0],e=e.substring(y.length+1);if(a){if(r&&!t(e))return;e=decodeURIComponent(e)}m=e}else{var e=f[b][0],y=e.split("=",1)[0],e=e.substring(y.length+1);if(a){if(r&&!t(e))return;e=decodeURIComponent(e)}f[b][0]=e,m=f[b]}if(a){if(r&&!t(y))return;y=decodeURIComponent(y)}void 0!==g[y]?Array.isArray(g[y])?g[y].push(m):g[y]=[g[y],m]:g[y]=m}}1==Object.keys(g).length&&void 0!==g[o]?n[o]=g[o]:n[o]=g}else{if(a)for(var b=0;b<f.length;b++){var v=f[b];if(Array.isArray(v))for(var j=0;j<v.length;j++){if(r&&!t(v[j]))return;v[j]=decodeURIComponent(v[j])}else{if(r&&!t(v))return;f[b]=decodeURIComponent(v)}}void 0!==n[o]?Array.isArray(n[o])?n[o]=n[o].concat(f):n[o]=[n[o]].concat(f):1!=f.length||i.suffices["*"]?n[o]=f:n[o]=f[0]}}else{for(var f=1==d.length?[e]:e.split(u||","),O={},p=0;p<f.length;p++){for(var w=0;w<d.length-1&&w<p&&!d[w].suffices["*"];w++);if(w!=p){for(var x=d.length-1;x>0&&d.length-x<f.length-p&&!d[x].suffices["*"];x--);d.length-x!=f.length-p?O[p]=w:O[p]=x}else O[p]=p}for(var p=0;p<f.length;p++){var e=f[p];if(e||!s){var v=e.split(","),l=!1;if(s){var e=v[0],o=e.split("=",1)[0],e=e.substring(o.length+1);v[0]=e;var i=h[o]||d[0]}else var i=d[O[p]],o=i.name;for(var b=0;b<v.length;b++)if(a){if(r&&!t(v[b]))return;v[b]=decodeURIComponent(v[b])}(s||i.suffices["*"])&&void 0!==n[o]?Array.isArray(n[o])?n[o]=n[o].concat(v):n[o]=[n[o]].concat(v):1!=v.length||i.suffices["*"]?n[o]=v:n[o]=v[0]}}}return 1}}}function r(e){if(!(this instanceof r))return new r(e);for(var t=e.split("{"),i=[t.shift()],o=[],u=[],c=[],a=[];t.length>0;){var s=t.shift(),f=s.split("}")[0],l=s.substring(f.length+1),p=n(f);u.push(p.substitution),c.push(p.unSubstitution),o.push(p.prefix),i.push(l),a=a.concat(p.varNames)}this.fill=function(e){if(e&&"function"!=typeof e){var t=e;e=function(e){return t[e]}}for(var n=i[0],r=0;r<u.length;r++){n+=(0,u[r])(e),n+=i[r+1]}return n},this.fromUri=function(e,t){t=t||{};for(var n={},r=0;r<i.length;r++){var u=i[r];if(e.substring(0,u.length)!==u)return;if(e=e.substring(u.length),r>=i.length-1){if(""==e)break;return}var a=o[r];if(!a||e.substring(0,a.length)===a){for(var s=i[r+1],f=r;;){if(f==i.length-2){var l=e.substring(e.length-s.length);if(l!==s)return;var p=e.substring(0,e.length-s.length);e=l}else if(s){var d=e.indexOf(s),p=e.substring(0,d);e=e.substring(d)}else if(o[f+1]){var d=e.indexOf(o[f+1]);-1===d&&(d=e.length);var p=e.substring(0,d);e=e.substring(d)}else{if(i.length>f+2){f++,s=i[f+1];continue}var p=e;e=""}break}if(!c[r](p,n,t.strict))return}}return n},this.varNames=a,this.template=e}var i={"+":!0,"#":!0,".":!0,"/":!0,";":!0,"?":!0,"&":!0},o={"*":!0};return r.prototype={toString:function(){return this.template},fillFromObject:function(e){return this.fill(e)},test:function(e,t){return!!this.fromUri(e,t)}},r})}),be=function(e){return{processOption:function(t,n){return t=n(t),t.url=e,t.uriTemplate&&(e=e instanceof URL?e.href:String(e||""),t.uri=new ge(String(decodeURIComponent(e))),delete t.uriTemplate),t}}},me=function(e){return{processOption:function(t,n){return t=n(t),t.credentials=e||"include",t}}},ye=Object.freeze({body:pe,headers:de,method:ve,url:be,credentials:me}),je=[],Oe=function(e,t){return T(e)||e instanceof URL?Object.assign({url:e},t):N(e)?Object.assign(e,t):{}},we=function(e){return Object.keys(e).reduce(function(t,n){return ye[n]?t.concat(ye[n](e[n])):t},[])},xe=function(e){return{processBeforeOption:function(t){var n=ae(this,t);return t.params=Object.assign(n(ie,t,t.params),n(ie,t,e)),t}}},Ae=function(e,t){var n=Object.assign({url:"/",method:"get",headers:{Accept:"application/json","Content-Type":"application/x-www-form-urlencoded;charset=UTF-8"}},t),r=b(function(){function e(){}return e.prototype.options=function(){return n},e}());return n.data&&(n.params=n.data),r.extension(se),r.extension(e),r.extension(je),r.post("request",r.post("afterOption",r.post("option",r.post("beforeOption",n))))},Ce=function(e,t){var n=Oe(e,t);return g?g(n):Ae(we(n),n)},_e=function(e){g=e},Se=function(e,t){if(R(e))return function(t){return Promise.resolve(e(t))};var n=Oe(e,t),r=we(n);return function(e){return Ae([xe(e)].concat(r),n)}},ke=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];je=je.concat(e)},Pe=function(e){je=je.concat(le(e))};e.fetch=Ce,e.patch=_e,e.resource=Se,e.extension=ke,e.interceptor=Pe,Object.defineProperty(e,"__esModule",{value:!0})});