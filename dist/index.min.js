!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t(e.Mfetch=e.Mfetch||{})}(this,function(e){"use strict";function t(e){return e&&e.__esModule?e.default:e}function r(e,t){return t={exports:{}},e(t,t.exports),t.exports}function n(e){if(null===e||void 0===e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}function i(e){switch(e.arrayFormat){case"index":return function(t,r,n){return null===r?[u(t,e),"[",n,"]"].join(""):[u(t,e),"[",u(n,e),"]=",u(r,e)].join("")};case"bracket":return function(t,r){return null===r?u(t,e):[u(t,e),"[]=",u(r,e)].join("")};default:return function(t,r){return null===r?u(t,e):[u(t,e),"=",u(r,e)].join("")}}}function o(e){var t;switch(e.arrayFormat){case"index":return function(e,r,n){if(t=/\[(\d*)\]$/.exec(e),e=e.replace(/\[\d*\]$/,""),!t)return void(n[e]=r);void 0===n[e]&&(n[e]={}),n[e][t[1]]=r};case"bracket":return function(e,r,n){return t=/(\[\])$/.exec(e),e=e.replace(/\[\]$/,""),t?void 0===n[e]?void(n[e]=[r]):void(n[e]=[].concat(n[e],r)):void(n[e]=r)};default:return function(e,t,r){if(void 0===r[e])return void(r[e]=t);r[e]=[].concat(r[e],t)}}}function u(e,t){return t.encode?t.strict?x(e):encodeURIComponent(e):e}function a(e){return Array.isArray(e)?e.sort():"object"==typeof e?a(Object.keys(e)).sort(function(e,t){return Number(e)-Number(t)}).map(function(t){return e[t]}):e}function c(e){return $.call(e).slice(8,-1)}function s(e){var t=e.map(function(e){return"["+e+"]"});return t[0]=e[0],t.join("")}function f(e){if(!R(e))throw new TypeError("Argument must be object");var t=new J,r=new P(e),n=function(e,r,n){var i=s(e);H(n)?t.append(i,r):t.append(i,r,n)};r.onStepInto=function(e){e.parent;switch(c(e.node)){case"Array":case"Object":case"FileList":return!0;default:return!1}};for(var i=0,o=r;i<o.length;i+=1){var u=o[i],a=u.node,f=u.path;switch(c(a)){case"Array":case"Object":case"FileList":break;case"File":n(f,a);break;case"Blob":n(f,a,a.name);break;default:n(f,a)}}return t}function l(e){for(var t={},r=0,n=e.keys();r<n.length;r+=1){var i=n[r];t.hasOwnProperty(i)?t[i]=e.getAll(i):t[i]=e.get(i)}return t}var p="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},d=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=t.isType=function(e){return function(t){return null!=t&&Object.prototype.toString.call(t)==="[object "+e+"]"}};t.isFn=r("Function"),t.isArr=Array.isArray||r("Array"),t.isObj=r("Object"),t.isStr=r("String"),t.isNum=r("Number")});t(d);var h=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.lowerCase=t.each=t.extend=t.isValidThen=t.isValid=t.hasOwn=t.hasOwnProperty=t.obj=t.getStr=t.getFn=t.noop=void 0;var r=d,n=t.noop=function(e){return function(){return e}},i=(t.getFn=function(e,t){return(0,r.isFn)(e)?e:n(t)},t.getStr=function(e){return(0,r.isStr)(e)?e:""}),o=(t.obj=function(){return Object.create(null)},t.hasOwnProperty=Object.prototype.hasOwnProperty),u=t.hasOwn=function(e,t){return o.call(e,t)},a=t.isValid=function(e){return void 0!==e&&null!==e};t.isValidThen=function(e,t){return a(e)?e:t},t.extend=function(e,t){for(var r in t)e[r]=t[r];return e},t.each=function(e,t){if((0,r.isFn)(t))if((0,r.isArr)(e))for(var n=0,i=e.length;n<i&&!1!==t(e[n],n);n++);else for(var o in e)if(u(e,o)&&!1===t(e[o],o))break},t.lowerCase=function(e){return i(e).toLowerCase()}});t(h);var v=r(function(e,t){function r(e){function t(t,r,o){return function(t){var u=new e(t),a=(0,i.getFn)(o,t);(0,n.isFn)(u.beforeEach)&&u.beforeEach(t);var c=r.call(u,t,a);return(0,n.isFn)(u.afterEach)&&u.afterEach(c),c}}function r(e){return f[e]?f[e]:(f[e]=(0,i.lowerCase)(e).replace(/process/i,""),f[e])}function o(e,u){if((0,n.isObj)(e))(0,i.each)(e,function(e,t){o(t,e)});else{if(e=r(e),!(0,n.isFn)(u))return;s[e]=t(e,u,s[e])}}function u(e,t,o){return(0,n.isStr)(e)&&e.length&&(e=r(e),(0,n.isFn)(s[e]))?s[e](t):(0,i.isValidThen)(o,t)}function a(e,t){if(!(0,i.isValid)(t))return cached[e];cached[e]=t}function c(e){(0,n.isArr)(e)?(0,i.each)(e,function(e){return c(e)}):(0,n.isFn)(e)?e(l):o(e)}var s=(0,i.obj)(),f=(0,i.obj)();e=e||(0,i.noop)();var l={process:o,post:u,extension:c,cache:a};return e.prototype=(0,i.extend)(e.prototype,l),l}Object.defineProperty(t,"__esModule",{value:!0}),t.createPluginService=r;var n=d,i=h});t(v);var g,b=v.createPluginService,m=function(e){return encodeURIComponent(e).replace(/[!'()*]/g,function(e){return"%"+e.charCodeAt(0).toString(16).toUpperCase()})},y=Object.getOwnPropertySymbols,j=Object.prototype.hasOwnProperty,O=Object.prototype.propertyIsEnumerable,w=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},r=0;r<10;r++)t["_"+String.fromCharCode(r)]=r;if("0123456789"!==Object.getOwnPropertyNames(t).map(function(e){return t[e]}).join(""))return!1;var n={};return"abcdefghijklmnopqrst".split("").forEach(function(e){n[e]=e}),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},n)).join("")}catch(e){return!1}}()?Object.assign:function(e,t){for(var r,i,o=arguments,u=n(e),a=1;a<arguments.length;a++){r=Object(o[a]);for(var c in r)j.call(r,c)&&(u[c]=r[c]);if(y){i=y(r);for(var s=0;s<i.length;s++)O.call(r,i[s])&&(u[i[s]]=r[i[s]])}}return u},x=m,A=w,C=function(e){return e.split("?")[1]||""},_=function(e,t){t=A({arrayFormat:"none"},t);var r=o(t),n=Object.create(null);return"string"!=typeof e?n:(e=e.trim().replace(/^(\?|#|&)/,""))?(e.split("&").forEach(function(e){var t=e.replace(/\+/g," ").split("="),i=t.shift(),o=t.length>0?t.join("="):void 0;o=void 0===o?null:decodeURIComponent(o),r(decodeURIComponent(i),o,n)}),Object.keys(n).sort().reduce(function(e,t){var r=n[t];return Boolean(r)&&"object"==typeof r&&!Array.isArray(r)?e[t]=a(r):e[t]=r,e},Object.create(null))):n},S=function(e,t){t=A({encode:!0,strict:!0,arrayFormat:"none"},t);var r=i(t);return e?Object.keys(e).sort().map(function(n){var i=e[n];if(void 0===i)return"";if(null===i)return u(n,t);if(Array.isArray(i)){var o=[];return i.slice().forEach(function(e){void 0!==e&&o.push(r(n,e,o.length))}),o.join("&")}return u(n,t)+"="+u(i,t)}).filter(function(e){return e.length>0}).join("&"):""},k={extract:C,parse:_,stringify:S},F=r(function(e,t){!function(r,n){"object"==typeof t&&"object"==typeof e?e.exports=n():"function"==typeof define&&define.amd?define([],n):"object"==typeof t?t.RecursiveIterator=n():r.RecursiveIterator=n()}(p,function(){return function(e){function t(n){if(r[n])return r[n].exports;var i=r[n]={exports:{},id:n,loaded:!1};return e[n].call(i.exports,i,i.exports,t),i.loaded=!0,i.exports}var r={};return t.m=e,t.c=r,t.p="",t(0)}([function(e,t,r){var n=function(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)},i=function(e,t,r){t&&Object.defineProperties(e,t),r&&Object.defineProperties(e.prototype,r)},o=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},u=r(1),a=u.isObject,c=u.getKeys,s="__bypassMode",f="__ignoreCircular",l="__maxDeep",p="__cache",d="__queue",h="__state",v={},g=function(){function e(t){var r=void 0===arguments[1]?0:arguments[1],n=void 0!==arguments[2]&&arguments[2],i=void 0===arguments[3]?100:arguments[3];o(this,e),this[s]=r,this[f]=n,this[l]=i,this[p]=[],this[d]=[],this[h]=this.getState(void 0,t),this.__makeIterable()}return i(e,null,{next:{value:function(){var e=this[h]||v,t=e.node,r=e.path,i=e.deep;if(this[l]>i&&this.isNode(t))if(this.isCircular(t)){if(!this[f])throw new Error("Circular reference")}else if(this.onStepInto(this[h])){var o,u=this.getStatesOfChildNodes(t,r,i),a=this[s]?"push":"unshift";(o=this[d])[a].apply(o,n(u)),this[p].push(t)}var c=this[d].shift(),g=!c;return this[h]=c,g&&this.destroy(),{value:c,done:g}},writable:!0,configurable:!0},destroy:{value:function(){this[d].length=0,this[p].length=0,this[h]=null},writable:!0,configurable:!0},isNode:{value:function(e){return a(e)},writable:!0,configurable:!0},isLeaf:{value:function(e){return!this.isNode(e)},writable:!0,configurable:!0},isCircular:{value:function(e){return-1!==this[p].indexOf(e)},writable:!0,configurable:!0},getStatesOfChildNodes:{value:function(e,t,r){var n=this;return c(e).map(function(i){return n.getState(e,e[i],i,t.concat(i),r+1)})},writable:!0,configurable:!0},getState:{value:function(e,t,r){return{parent:e,node:t,key:r,path:void 0===arguments[3]?[]:arguments[3],deep:void 0===arguments[4]?0:arguments[4]}},writable:!0,configurable:!0},onStepInto:{value:function(e){return!0},writable:!0,configurable:!0},__makeIterable:{value:function(){var e=this;try{this[Symbol.iterator]=function(){return e}}catch(e){}},writable:!0,configurable:!0}}),e}();e.exports=g},function(e,t){function r(e){return null!==e&&"object"==typeof e}function n(e){if(!r(e))return!1;if(!("length"in e))return!1;var t=e.length;if(!i(t))return!1;if(t>0)return t-1 in e;for(var n in e)return!1}function i(e){return"number"==typeof e}function o(e){var t=Object.keys(e);if(u(e));else if(n(e)){var r=t.indexOf("length");r>-1&&t.splice(r,1)}else t=t.sort();return t}t.isObject=r,t.isArrayLike=n,t.isNumber=i,t.getKeys=o;var u=t.isArray=Array.isArray;Object.defineProperty(t,"__esModule",{value:!0})}])})}),P=t(F),U=function(e){return function(t){return Object.prototype.toString.call(t)==="[object "+e+"]"}},I=U("Function"),N=Array.isArray||U("Array"),R=U("Object"),E=U("String"),T=U("Number"),q=function(e){return N(e)||R(e)},M=U("FormData"),L=U("File"),H=U("Undefined"),B=U("Null"),V=U("Number"),z=function(e){return String(e).toLocaleLowerCase()},D=function(e){return z(e.method)},J=window.FormData,K=Object.prototype,$=K.toString,G=function(e){return z(String(e)).replace(/\s+/gi,"")},Q=function(e,t){return G(e)===G(t)},W=function(e){return G(N(e)?e.join("/"):E(e)?e:"")},X=function(e){return Object.keys(e||{})},Y=function(e,t){return e?X(e).some(function(e){return Q(e,t)}):e},Z=function(e,t){if(!e)return e;for(var r=X(e),n=0;n<r.length;n++){e[r[n]];if(Q(t,r[n]))return r[n]}return""},ee=function(e,t){return e?e[Z(e,t)]||"":e},te=function(e,t){return e?(delete e[Z(e,t)],e):e},re=function(e,t){if(!e)return!1;var r=e.headers;X(r);return!!Y(r,"content-type")&&ee(r,"content-type").indexOf(W(t))>-1},ne=function(e,t){X(e);return X(t).reduce(function(e,r){var n=Z(e,r);return n?e[n]=t[r]:e[r]=t[r],e},e||{})},ie=function(e,t,r,n){return Promise.resolve(t(e)).then(function(e){return Promise.resolve(r?r(e):e)},function(e){return Promise.reject(n?n(e):e)})},oe=function(e){if(e instanceof URL)return e;var t=document.createElement("a");return t.href=e,t},ue=function(e){var t=e.query_string;return function(e,r,n){var i=oe(r);return i.search=t.stringify(n,e),i.href}},ae=function(e){var t=e.query_string;return function(e,r){return t.parse(t.extract(oe(r).search),e)}},ce=function(e){var t=e.query_string,r=e.form_data;return function(e,n){var i={};return E(n)?t.parse(n,e):M(n)?r.parse(n,e):R(n)?n:i}},se=function(e){var t=e.query_string,r=e.form_data;return function(e,n){var i=function(t){return re(e,t)};return i(["application","json"])?JSON.stringify(n):i(["multipart","formdata"])||i(["multipart","form-data"])?(te(e.headers,"content-type"),r.formify(n,e)):t.stringify(n,e)}},fe=function(e,t){return Object.keys(e||{}).reduce(function(r,n){return-1==t.indexOf(n)&&(r[n]=e[n]),r},{})},le=function(e,t){return Object.keys(e||{}).reduce(function(r,n){return t.indexOf(n)>-1&&(r[n]=e[n]),r},{})},pe=function(e,t){return function(r){for(var n=[],i=arguments.length-1;i-- >0;)n[i]=arguments[i+1];return r(e.post("serializer",t)).apply(void 0,n)}},de=Object.freeze({isType:U,isFn:I,isArr:N,isObj:R,isStr:E,isNum:T,isIter:q,isForm:M,isFile:L,isUndefined:H,isNull:B,isNumber:V,lowerCase:z,getMethod:D,json2formdata:f,formdata2json:l,cleanMs:G,header:W,getHeaderKeys:X,hasHeader:Y,findHeaderKey:Z,getHeader:ee,removeHeader:te,contentTypeIs:re,mergeHeaders:ne,process:ie,parseUrl:oe,appendUrl:ue,extractUrl:ae,extractParams:ce,transformParams:se,filterParams:fe,pickParams:le,createSerializer:pe}),he={processFetch:function(e,t){return e=t(e),this.options=e,window.fetch(e.url,e)},processRequest:function(e,t){var r=this;return ie(e,t,function(e){if(V(e.timeout)){var t=e.timeout;delete e.timeout;var n,i=new Promise(function(e,t){n=function(e){t(e)}});setTimeout(function(){var t=new Error('[MFETCH Error] request "'+e.url+'" is timeout!');t.isTimeout=!0,n(t)},t);var o=Promise.race([r.post("fetch",e),i]);return o.abort=n,r.post("response",o)}return r.post("response",r.post("fetch",e))})},processSerializer:function(e){return{query_string:{parse:k.parse,stringify:k.stringify,extract:k.extract},form_data:{parse:l,formify:f}}},processAfterOption:function(e,t){e=t(e);var r=e.uri?e.uri.varNames:[],n=pe(this,e);switch(e.params=n(ce,e,e.params),e.url=e.uri?e.uri.fill(le(e.params,r)):e.url,delete e.uri,D(e)){case"get":case"jsonp":case"head":var i=Object.assign(n(ae,e,e.url),fe(e.params,r));return e.url=n(ue,e,e.url,i),e;default:return e.body=n(se,e,Object.assign(n(ce,e,e.body),fe(e.params,r))),e}}},ve={request:function(e){return{processAfterOption:function(t,r){return Promise.resolve(I(e)?e(t,this.options):t).then(function(e){return r(e)})}}},response:function(e){return{processResponse:function(t,r){var n=this;return ie(t,r,function(t){return I(e)?e(t,n.options):t})}}},resolve:function(e){return{processResponse:function(t,r){var n=this;return ie(t,r,function(t){return I(e)?e(t,n.options):t})}}},reject:function(e){return{processResponse:function(t,r){var n=this;return ie(t,r,function(e){return e},function(t){return I(e)?e(t,n.options):t})}}}},ge=function(e){return Object.keys(e||{}).reduce(function(t,r){return ve[r]&&I(e[r])?t.concat(ve[r](e[r].bind(e))):t},[])},be=function(e){return{processOption:function(t,r){switch(t=r(t),D(t)){case"get":case"head":return t;default:return t.body=e,t}}}},me=function(e){return{processOption:function(t,r){return t=r(t),t.headers=ne(t.headers,e),t}}},ye=r(function(e,t){!function(r,n){if("function"==typeof define&&define.amd)define(["exports","module"],n);else if(void 0!==t&&void 0!==e)n(t,e);else{var i={exports:{}};n(i.exports,i),r.fetchJsonp=i.exports}}(p,function(e,t){function r(){return"jsonp_"+Date.now()+"_"+Math.ceil(1e5*Math.random())}function n(e){try{delete window[e]}catch(t){window[e]=void 0}}function i(e){var t=document.getElementById(e);t&&document.getElementsByTagName("head")[0].removeChild(t)}function o(e){var t=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],o=e,a=t.timeout||u.timeout,c=t.jsonpCallback||u.jsonpCallback,s=void 0;return new Promise(function(u,f){var l=t.jsonpCallbackFunction||r(),p=c+"_"+l;window[l]=function(e){u({ok:!0,json:function(){return Promise.resolve(e)}}),s&&clearTimeout(s),i(p),n(l)},o+=-1===o.indexOf("?")?"?":"&";var d=document.createElement("script");d.setAttribute("src",""+o+c+"="+l),t.charset&&d.setAttribute("charset",t.charset),d.id=p,document.getElementsByTagName("head")[0].appendChild(d),s=setTimeout(function(){f(new Error("JSONP request to "+e+" timed out")),n(l),i(p),window[l]=function(){n(l)}},a),d.onerror=function(){f(new Error("JSONP request to "+e+" failed")),n(l),i(p),s&&clearTimeout(s)}})}var u={timeout:5e3,jsonpCallback:"callback",jsonpCallbackFunction:null};t.exports=o})}),je=function(e){return{processOption:function(t,r){return t=r(t),t.method=z(e),t.method.indexOf("get")>-1&&t.headers&&(t.headers=te(t.headers,"content-type")),t},processFetch:function(e,t){return"jsonp"==e.method?ye(e.url,e):t(e)}}},Oe=r(function(e){!function(t,r){"function"==typeof define&&define.amd?define("uri-templates",[],r):void 0!==e&&e.exports?e.exports=r():t.UriTemplate=r()}(p,function(){function e(e){return encodeURI(e).replace(/%25[0-9][0-9]/g,function(e){return"%"+e.substring(3)})}function t(e){return e=e.replace(/%../g,""),encodeURIComponent(e)===e}function r(r){var n="";i[r.charAt(0)]&&(n=r.charAt(0),r=r.substring(1));var u="",a="",c=!0,s=!1,f=!1;"+"==n?c=!1:"."==n?(a=".",u="."):"/"==n?(a="/",u="/"):"#"==n?(a="#",c=!1):";"==n?(a=";",u=";",s=!0,f=!0):"?"==n?(a="?",u="&",s=!0):"&"==n&&(a="&",u="&",s=!0);for(var l=[],p=r.split(","),d=[],h={},v=0;v<p.length;v++){var g=p[v],b=null;if(-1!=g.indexOf(":")){var m=g.split(":");g=m[0],b=parseInt(m[1])}for(var y={};o[g.charAt(g.length-1)];)y[g.charAt(g.length-1)]=!0,g=g.substring(0,g.length-1);var j={truncate:b,name:g,suffices:y};d.push(j),h[g]=j,l.push(g)}return{varNames:l,prefix:a,substitution:function(t){for(var r="",n=0,i=0;i<d.length;i++){var o=d[i],l=t(o.name);if(null==l||Array.isArray(l)&&0==l.length||"object"==typeof l&&0==Object.keys(l).length)n++;else if(r+=i==n?a:u||",",Array.isArray(l)){s&&(r+=o.name+"=");for(var p=0;p<l.length;p++)p>0&&(r+=o.suffices["*"]?u||",":",",o.suffices["*"]&&s&&(r+=o.name+"=")),r+=c?encodeURIComponent(l[p]).replace(/!/g,"%21"):e(l[p])}else if("object"==typeof l){s&&!o.suffices["*"]&&(r+=o.name+"=");var h=!0;for(var v in l)h||(r+=o.suffices["*"]?u||",":","),h=!1,r+=c?encodeURIComponent(v).replace(/!/g,"%21"):e(v),r+=o.suffices["*"]?"=":",",r+=c?encodeURIComponent(l[v]).replace(/!/g,"%21"):e(l[v])}else s&&(r+=o.name,f&&""==l||(r+="=")),null!=o.truncate&&(l=l.substring(0,o.truncate)),r+=c?encodeURIComponent(l).replace(/!/g,"%21"):e(l)}return r},unSubstitution:function(e,r,n){if(a&&(e=e.substring(a.length)),1==d.length&&d[0].suffices["*"]){for(var i=d[0],o=i.name,f=i.suffices["*"]?e.split(u||","):[e],l=c&&-1!=e.indexOf("="),p=1;p<f.length;p++){var e=f[p];l&&-1==e.indexOf("=")&&(f[p-1]+=(u||",")+e,f.splice(p,1),p--)}for(var p=0;p<f.length;p++){var e=f[p];c&&-1!=e.indexOf("=")&&(l=!0);var v=e.split(",");1==v.length?f[p]=v[0]:f[p]=v}if(s||l){for(var g=r[o]||{},b=0;b<f.length;b++){var m=e;if(!s||m){if("string"==typeof f[b]){var e=f[b],y=e.split("=",1)[0],e=e.substring(y.length+1);if(c){if(n&&!t(e))return;e=decodeURIComponent(e)}m=e}else{var e=f[b][0],y=e.split("=",1)[0],e=e.substring(y.length+1);if(c){if(n&&!t(e))return;e=decodeURIComponent(e)}f[b][0]=e,m=f[b]}if(c){if(n&&!t(y))return;y=decodeURIComponent(y)}void 0!==g[y]?Array.isArray(g[y])?g[y].push(m):g[y]=[g[y],m]:g[y]=m}}1==Object.keys(g).length&&void 0!==g[o]?r[o]=g[o]:r[o]=g}else{if(c)for(var b=0;b<f.length;b++){var v=f[b];if(Array.isArray(v))for(var j=0;j<v.length;j++){if(n&&!t(v[j]))return;v[j]=decodeURIComponent(v[j])}else{if(n&&!t(v))return;f[b]=decodeURIComponent(v)}}void 0!==r[o]?Array.isArray(r[o])?r[o]=r[o].concat(f):r[o]=[r[o]].concat(f):1!=f.length||i.suffices["*"]?r[o]=f:r[o]=f[0]}}else{for(var f=1==d.length?[e]:e.split(u||","),O={},p=0;p<f.length;p++){for(var w=0;w<d.length-1&&w<p&&!d[w].suffices["*"];w++);if(w!=p){for(var x=d.length-1;x>0&&d.length-x<f.length-p&&!d[x].suffices["*"];x--);d.length-x!=f.length-p?O[p]=w:O[p]=x}else O[p]=p}for(var p=0;p<f.length;p++){var e=f[p];if(e||!s){var v=e.split(","),l=!1;if(s){var e=v[0],o=e.split("=",1)[0],e=e.substring(o.length+1);v[0]=e;var i=h[o]||d[0]}else var i=d[O[p]],o=i.name;for(var b=0;b<v.length;b++)if(c){if(n&&!t(v[b]))return;v[b]=decodeURIComponent(v[b])}(s||i.suffices["*"])&&void 0!==r[o]?Array.isArray(r[o])?r[o]=r[o].concat(v):r[o]=[r[o]].concat(v):1!=v.length||i.suffices["*"]?r[o]=v:r[o]=v[0]}}}return 1}}}function n(e){if(!(this instanceof n))return new n(e);for(var t=e.split("{"),i=[t.shift()],o=[],u=[],a=[],c=[];t.length>0;){var s=t.shift(),f=s.split("}")[0],l=s.substring(f.length+1),p=r(f);u.push(p.substitution),a.push(p.unSubstitution),o.push(p.prefix),i.push(l),c=c.concat(p.varNames)}this.fill=function(e){if(e&&"function"!=typeof e){var t=e;e=function(e){return t[e]}}for(var r=i[0],n=0;n<u.length;n++){r+=(0,u[n])(e),r+=i[n+1]}return r},this.fromUri=function(e,t){t=t||{};for(var r={},n=0;n<i.length;n++){var u=i[n];if(e.substring(0,u.length)!==u)return;if(e=e.substring(u.length),n>=i.length-1){if(""==e)break;return}var c=o[n];if(!c||e.substring(0,c.length)===c){for(var s=i[n+1],f=n;;){if(f==i.length-2){var l=e.substring(e.length-s.length);if(l!==s)return;var p=e.substring(0,e.length-s.length);e=l}else if(s){var d=e.indexOf(s),p=e.substring(0,d);e=e.substring(d)}else if(o[f+1]){var d=e.indexOf(o[f+1]);-1===d&&(d=e.length);var p=e.substring(0,d);e=e.substring(d)}else{if(i.length>f+2){f++,s=i[f+1];continue}var p=e;e=""}break}if(!a[n](p,r,t.strict))return}}return r},this.varNames=c,this.template=e}var i={"+":!0,"#":!0,".":!0,"/":!0,";":!0,"?":!0,"&":!0},o={"*":!0};return n.prototype={toString:function(){return this.template},fillFromObject:function(e){return this.fill(e)},test:function(e,t){return!!this.fromUri(e,t)}},n})}),we=function(e){return{processOption:function(t,r){return t=r(t),t.url=e,t.uriTemplate&&(e=e instanceof URL?e.href:String(e||""),t.uri=new Oe(String(decodeURIComponent(e))),delete t.uriTemplate),t}}},xe=function(e){return{processOption:function(t,r){return t=r(t),t.credentials=e||"include",t}}},Ae=Object.freeze({body:be,headers:me,method:je,url:we,credentials:xe}),Ce=I,_e=R,Se=E,ke=pe,Fe=ce,Pe=[],Ue=function(e,t){return Se(e)||e instanceof URL?Object.assign({url:e},t):_e(e)?Object.assign(e,t):{}},Ie=function(e){return Object.keys(e).reduce(function(t,r){return Ae[r]?t.concat(Ae[r](e[r])):t},[])},Ne=function(e){return{processBeforeOption:function(t){var r=ke(this,t);return t.params=Object.assign(r(Fe,t,t.params),r(Fe,t,e)),t}}},Re=function(e,t){var r=b(function(){function e(){}return e.prototype.options=function(){return t},e}());return t.data&&(t.params=t.data),r.extension(he),r.extension(e),r.extension(Pe),r.post("request",r.post("afterOption",r.post("option",r.post("beforeOption",t))))},Ee=function(e,t){var r=Ue(e,Object.assign({method:"get",headers:{Accept:"application/json","Content-Type":"application/x-www-form-urlencoded;charset=UTF-8"}},t));return g?g(r):Re(Ie(r),r)},Te=function(e){g=e},qe=function(e,t){if(Ce(e))return function(t){return Promise.resolve(e(t))};var r=Ue(e,t),n=Ie(r);return function(e){return Re([Ne(e)].concat(n),r)}},Me=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];Pe=Pe.concat(e)},Le=function(e){Pe=Pe.concat(ge(e))};Object.assign(module.exports,de),e.fetch=Ee,e.patch=Te,e.resource=qe,e.extension=Me,e.interceptor=Le,Object.defineProperty(e,"__esModule",{value:!0})});